# Лабораторная работа №5 "Решение СЛАУ методом Якоби"

## Необходимо

Решить матричное уравнение $Ax = b$ итеративным методом Якоби.

Дополнительно вывести время выполнения программы в терминал

### Вывод итеративной формулы

$$ (A - D)x + Dx = b $$

$$ Dx = b - (A - D)x $$

$$ x = D^{-1}b - D^{-1}(A - D)x = Bx + g $$

$D$ — матрица, у которой на главной диагонали стоят соответствующие элементы матрицы $A$, а все остальные нули.

Основная расчётная формула:

$$ x^{\{i+1\}} = Bx^{\{i\}} + g $$

$$ B = - D^{-1}(A - D); \quad g = D^{-1}b $$

Чтобы получить матрицу $B$ необходимо для каждой строки матрицы $A$:
1. разделить строку на соответствующий диагональный элемент этой строки
2. умножить на -1
3. заменить диагональный элемент на 0

Чтобы получить вектор $g$ необходимо разделить компоненты вектора $b$ на соответствующие диагональные элементы матрицы $A$.

### Условие остановки

Остановка итеративного процесса происходит если изменение вектора $x$ меньше определённого значения, либо если решение не сходится и превышен предел числа итераций.

Изменение вектора берём по модулю: $| x^{\{i+1\}} - x^{\{i\}} | \leq eps$, где $|...|$ — евклидова норма:

$$ |x| = \sum_{i=1}^{N} (x_i)^2$$


## Дано

Файл B:

```
6
7
1.0 -0.2 -0.3 -0.4  0.5 0.5  -7
0.1 -1.0  0.1  0.6  0.6 0.1  1
0.1 -0.3 -6.0 -0.9  0.1 0.3  1
0.1  0.9 -0.2  11.0 0.1 0.1  0
0.1 -0.1 -0.3 -0.3  1.0 0.1  -1
0.1 -0.5 -0.5 -0.5 -0.5 1.0  0
```
Где:  
6 — число строк  
7 — число столбцов  
далее матрица(число строк x число столбцов)

Первые 6 столбцов — это матрица $A$, а последний столбец — это вектор $b$.

### Численное решение

$$ \displaylines{
x_1 = -6.8827332373410695 \\
x_2 = -1.9070754115196793 \\
x_3 = -0.2526395704453912 \\
x_4 =  0.2228346591364654 \\
x_5 = -0.4603419114690658 \\
x_6 = -0.5103377934147283
} $$

Оно же в виде вектора с разной точностью:
```
-6.8827332373410695   -1.9070754115196793   -0.2526395704453912    0.2228346591364654   -0.4603419114690658   -0.5103377934147283

-6.8827332 -1.9070754 -0.2526396 0.2228347 -0.4603419 -0.5103378

-6.88   -1.91   -0.25    0.22   -0.46   -0.51
```

## Псевдокод
```
если (процесс == 0) {
   прочитать матрицу
   разделить матрицу на матрицу A и вектор b
   рассчитать матрицы B и g

   рассчитать число строк в ленте для каждого процесса
}

разослать размеры лент и векторов
разослать ленты матрицы A
разослать фрагменты вектора b

пока (ошибка > допустимой) {
    рассчитать фрагмент нового вектора x^{i+1}
    разослать на все процессы рассчитанный фрагмент
    рассчитать ошибку
}

если (процесс == 0) {
    ! результат уже есть на 0 процессе, 
    ! поскольку он также участвует в решении и 
    ! в конце каждой итерации получает весь вектор x
    
    вывести результат в терминал
}
```

## Изучаемые элементы

`MPI_ALLGATHERV` — сборка данных разной длины со всех процессов на каждом
